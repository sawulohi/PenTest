Testaukset tehty Windows 10 käyttöjärjestelmällä, Version 10.0.19045 Build 19045. Tämän lisäksi käytetty myös Kali Linux versio 2023.3 ajettuna VirtualBox Version 7.0.12 r159484 (Qt5.15.2) kautta,  Prosessorina Intel(R) Core(TM) i7-8700K CPU @ 3.70GHz, 16GB RAM

[https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h5-injected-sequel](https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h5-injected-sequel)

#### x) Lue/katso/kuuntele ja tiivistä.

  * Karvinen 2016: [PostgreSQL Install and One Table Database – SQL CRUD tutorial for Ubuntu](https://terokarvinen.com/2016/03/05/postgresql-install-and-one-table-database-sql-crud-tutorial-for-ubuntu/)

    - Ohjeet PostgreSQL-tietokantapalvelimen asennukseen
    - "Kolmen rivin asennus": 

```
$ sudo apt-get update
$ sudo apt-get -y install postgresql
$ sudo systemctl start postgresql # needed in 2023
$ sudo -u postgres createdb $(whoami)
$ sudo -u postgres createuser $(whoami)
    
```
  * 
    - Tietokannan käynnistys `psql`, apua `help`, `\`-takakenomerkki ja kirjaimia ohjelman sisäisiin komentoihin, esim `\h SELECT` antaa apua SELECT-komennon käyttöön
    - Ohjeet taulukon luontiin sekä CRUDiin - Create, Read, Update, Delete
    - PostgreSQL käyttää SQL-komentoja (yllättävää, eikö?)

  * [OWASP 2017: A1:2017-Injection](https://owasp.org/www-project-top-ten/2017/A1_2017-Injection)
    
    - 2017 Yleisin käytetty haavoittuvuus
    - Melkein mitä tahansa datan lähdettä voidaan käyttää hyökkäysvektorina - muuttujat, parametrit, ulkoiset ja sisäiset weppipalvelut. Mahdollisuus lähettää haittakoodia tulkille riittää.
    - Haavoittuvuuksia löytyy etenkin vanhasta koodista. Niitä löytyy helposti koodia tutkimalla. Skannerit ja fuzzerit ovat hyviä työkaluja injektiovektoreiden löytämiseen.
    - Seuraukset voivat olla vakavia: Uhriorganisaatio saattaa menettää kriittistä dataa (joko ulkoisille toimijoille tai kokonaan) tai injektiolla voidaan ottaa uhri valtaan täysin.
    - Estäminen:
     - Validoidaan, filtteröidään ja/tai puhdistetaan (parametritetään) käyttäjien syöttämä data applikaatiotasolla
     - Whitelistaus sallituille merkeille - ei täysin toimiva, monet applikaatiot ja esim. mobiiliappien rajapinnat tarvitsevat erikoismerkkejä

    PortSwigger Academy: [SQL injection](https://portswigger.net/web-security/sql-injection)
        Kaikki muut luvut paitsi ei "Blind SQL injection"
        Tämä kappale kannattaa pitää näkyvissä injektioita tehdessä SQL injection cheat sheet
    Vapaaehtoinen: Karvinen 2019: MitmProxy on Kali and Xubuntu – attack and testing (Nykyisin asennus 'sudo apt-get install mitmproxy')

#### a) CRUD. Tee uusi PostgreSQL-tietokanta ja demonstroi sillä create, read, update, delete (CRUD). Keksi taulujen ja kenttien nimet itse. Taulujen nimet monikossa, kenttien nimet yksikössä, molemmat englanniksi.

#### b) SQLi me. Kuvaile yksinkertainen SQL-injektio, ja demonstroi se omaan tietokantaasi psql-komennolla. Selitä, mikä osa on käyttäjän syötettä ja mikä valmiina ohjelmassa. (Tässä harjoituksessa voit vain kertoa koodista, ei siis tarvitse välttämättä koodata sitä ohjelmaa, joka yhdistää käyttäjän syötteen SQL:n)

Käytetty vinkattua [SQL injection cheat sheettia PortSwiggeriltä](https://portswigger.net/web-security/sql-injection) (kohdat b\)-j\))

PortSwigger Labs

####    c) (Alakohta c poistettu, tämänhän ratkoimme jo aiemmin: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data)
####    d) SQL injection vulnerability allowing login bypass
####    e) SQL injection attack, querying the database type and version on Oracle
####   f) SQL injection attack, querying the database type and version on MySQL and Microsoft
####    g) SQL injection attack, listing the database contents on non-Oracle databases
####    h) SQL injection UNION attack, determining the number of columns returned by the query
####   i) SQL injection UNION attack, retrieving data from other tables
####    j) SQL injection UNION attack, retrieving multiple values in a single column

#### k) Vapaaaehtoinen: Mitmproxy. Demonstroi mitmproxy:n käyttöä terminaalista (TUI tai CLI).

#### l) Vapaaehtoinen: Attack lab. Asenna vapaavalintainen kone Vulnhubista ja murtaudu siihen.