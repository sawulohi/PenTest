Testaukset tehty Windows 10 käyttöjärjestelmällä, Version 10.0.19045 Build 19045. Tämän lisäksi käytetty myös Kali Linux versio 2023.3 ajettuna VirtualBoxin versio 6.1 kautta,  Prosessorina Intel(R) Core(TM) i7-8700K CPU @ 3.70GHz, 16GB RAM

[https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h1-hacker-warmup](https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h1-hacker-warmup)

#### x\) Lue/katso ja tiivistä.

Koska aihe oli minulle uusi, otin laajemmat muistiinpanot tulevia tehtäviä varten jo nyt.

  - [Hoikkala "joohoi" 2020: Still Fuzzing Faster (U fool). In HelSec Virtual meetup #1.](https://www.youtube.com/watch?v=mbmsT3AhwWU)
    - Esityksen pitäjänä "joohoi" Hoikkala, ffuf:in kehittäjä
    - Web fuzzing on HTTP-pyyntöjen lähettämistä palvelimelle
      - Pyyntöjä voidaan lähettää suuria määriä (jopa miljoonia)
      - Suodattaminen tapahtuu käyttäjän asettamien suodattimien mukaisesti
      - Samoin esim. subdomainien etsimiseen käytettävät kirjastot
      - Input contenttina voidaan antaa esim.
        * Salasanalistoja, käyttäjälistoja
        * Tunnettuja rajapintareittejä
        * Yleisiä resurssipolkuja, parametrien nimiä ja arvoja
        * Validin input datan mutaatioita
    - Tarkoituksena on saada palvelimelta vastauksia pyyntöihin, ja siten kartoittaa esim. palvelimen sisältöä
    - Yleisiä kohteita: 
      * GET-parametrit: nimet, arvot tai molemmat
      * Headerit: host, autentikaatio, keksit, proxy headerit
      * POST data: lomaketietoja, JSON, tiedostoja
    - Suodattimien lisäksi käytetään myös "matchereita", eli yhteneväisyyksiä
      - Matchereissa voidaan hyödyntää esim. sisältöä (regexejä), vastausten kokoa byteissä
    - Muita fuzzaus-työkaluja esim:
      * Burp
      * OWASP Zap
      * dirbuster
      * gobuster
    - Syy ffuf:n kehittämiseen oli gobusterin branchien refaktoroinnissa, joohoi olisi halunnut tehdä siihen committeja, mutta pyydettiin jarruttelemaan -> teki ffuf:n
    - Muutama demo:
      - `ffuf -w ~/SecLists/Discovery/Web-Content/big.txt -u https://ffuf.io.fi/FUZZ -e .php -c -v`
        * -w käytettävä sanalista polkuineen 
        * -u kohteen url
        * -e .php sisällyttää .php-tiedostopäätteen
        * -c värittää tekstin
        * -v verbose, eli selkokielinen (ihmisten käyttämä kieli) output
        * (-recursion lisää rekursiivisuuden, eli laajentaa pyynnöt kaikkiin hakemistoihin ja niiden alahakemistoihin, kestää joskus todella kauan)
        * big.txt sisältää laajan kattauksen
      - `curl -v -X POST https://ffuf.io/login.php -d 'username=something&password=somethingelse`
        * Pyyntö kirjautua sivustolle, johti errored statukseen
      - `ffuf -c -X POST -H "Content-Type: applivation/x-www-form-urlencoded -d 'username=USER&password=PASS' -u https://ffuf.io.fi/login.php -fr 'errored' -v -w users.txt:USER -w ~/SecLists/Passwords/darkweb2017-top10000.txt:PASS`
        * -X POST - HTTP POST-pyyntö
        * -H "Conte[...] - sisältötyyppi, vaaditaan koska moni lomakkeiden handler skippaisi pyynnöt jos tämä on määritelty väärin (määrittelemätön?)
        * -d 'username=USER&password=PASS' - capslockilla kirjoitetut kohdat haetaan sanalistoista
        * -fr 'errored' - suodattaa pois 'errored'-tilassa palaavat vastaukset (fr = filter response?)
        * -w users.txt:USER <- kohdistaa sanalistan USER "muuttujaan"
      - `ffuf -c -u https://USER:PASS@ffuf.io.fi/secure/ -v -w users.txt:USER -w ~/SecLists/Passwords/darkweb2017-top10000.txt:PASS -fc 401`
        * -fc 401 filtteröi ulos vastaukset jotka tulevat ulos 401 koodilla (auth epäonnistui)
        * ffuf:in tulos antoi onnistuneen vastauksen (status 200), user joohoi, password hunter1
      - Headerien fuzzaus `-H "Host: FUZZ.ffuf.io.fi`
        * -fs 16, filter size 16 - epäonnistunut demo, oikea käyttö jäi epäselväksi
      - Parametreihin esim.: `seq 1 10000 |fuff -c -v -u https://ffuf.io.fi/content.php?id=FUZZ -w - -fs 12 -od id_fuzz`
        * seq on GNU-työkalu joka käy numeroiden välin järjestyksessä
        * putki | vie sen fuffiin
        * -w - käyttää sanalistana seq:iä
        * -fs 12 filtteröi pois 12 byten vastaukset
        * -od id_fuzz vie tulokset erillisiin tiedostoihin jotka sisältävät pyynnöt ja vastaukset
    - [https://github.com/danielmiessler/SecLists](https://github.com/danielmiessler/SecLists) sanalistoja varten
    - joohoi panee oluita, esityksessään hän joi itsetehtyä Bock double ipaa

  -  Lyon 2009: Nmap Network Scanning: Chapter 15. Nmap Reference Guide:
      *  [Port Scanning Basics](https://nmap.org/book/man-port-scanning-basics.html) (opettele, mitä tarkoittavat: open, closed, filtered; muuten vain silmäily)
        - open: Applikaatio ottaa paketteja vastaan aktiivisesti. Yleisin maalitaulu porttiskannauksissa. Pentestaajat etsivät tietä sisään, adminit yrittävät tulimuurittaa pääsyn vaan sallituille
        - closed: Portti on saavutettavissa, mutta mikään applikaatio ei kuuntele sitä. Saattavat aueta myöhemmin, joten kuuntelu voi olla kannattavaa
        - filtered: Nmap ei saa tietoa portin avoimuudesta. Tulimuuri/reitittimen säännöt/hostipohjainen tulimuuri välissä. Vähän tietoa saatavissa, hidastavat skannaamista

      *  [Port Scanning Techniques](https://nmap.org/book/man-port-scanning-techniques.html) (opettele, mitä ovat: -sS -sT -sU; muuten vain silmäily)
        - sS: TCP SYN scan - suosituin, nopein, hienovarainen (unobstrusive) ja vaivihkainen. Ei koskaan tee TCP-yhteyksiä loppuun asti - pelkkä SYN paketti & SYN/ACK takaisin
        - sT: TCP connect scan - muodostaa TCP-yhteyden samaan tapaan kuin esim. nettiselaimet tai peer to peer-clientit. Huomattavampi toimenpide kuin esim. SYN scan - jättää selkeät jäljet yhteyksistä kohteen lokeihin.
        - sU: UDP scans - erityisesti DNS (53), SNMP (161/162) ja DHCP (67/68) käyttävät UDP:tä. Skannaus lähettää UDP-paketin jokaiseen kohdeporttiin. Paketin sisältö voidaan määritellä parametreillä kuten --data. Skannaus on usein hidas -> voi johtaa nmapin timeouttiin. Suljetut portit taas usein lähettävät takaisin ICMP unreachable -viestin.

---

#### a\) Fuff. Ratkaise [Teron ffuf-haastebinääri](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/?fromSearch=ffuf#your-turn---challenge).

Testasin ensin, onko ffuf esiasennettuna Kali Linuxissa, ja olihan se. Nähtävästi yleisimmät parametrit löytyivät myös antamalla pelkästään komennon `ffuf`. Kätevää.

```
┌──(kali㉿kali)-[~]
└─$ ffuf 
Encountered error(s): 2 errors occurred.
        * -u flag or -request flag is required
        * Either -w or --input-cmd flag is required

Fuzz Faster U Fool - v2.1.0-dev

HTTP OPTIONS:
  -H                  Header `"Name: Value"`, separated by colon. Multiple -H flags are accepted.
  -X                  HTTP method to use
  -b                  Cookie data `"NAME1=VALUE1; NAME2=VALUE2"` for copy as curl functionality.
  -cc                 Client cert for authentication. Client key needs to be defined as well for this to work
  -ck                 Client key for authentication. Client certificate needs to be defined as well for this to work
[...]

```

Latasin annetun harjoitusmaalin [weppisivulta](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/?fromSearch=ffuf#your-turn---challenge). Vaihdoin sen käyttöoikeuksiin suorittamisen käyttäjälle, ja latasin myös [Seclists sanakirjan](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/common.txt), jonka Daniel Miessler (ja muut) ovat tehneet valmiiksi.

```

┌──(kali㉿kali)-[~]
└─$ cd Downloads  
                                                                             
┌──(kali㉿kali)-[~/Downloads]
└─$ ls -l
total 2544
-rw-r--r-- 1 kali kali 2603332 Nov  4 17:48 dirfuzt-1
                                                                             
┌──(kali㉿kali)-[~/Downloads]
└─$ chmod u+x dirfuzt-1 
                                                                             
┌──(kali㉿kali)-[~/Downloads]
└─$ ls -l              
total 2544
-rwxr--r-- 1 kali kali 2603332 Nov  4 17:48 dirfuzt-1
                                                                             
┌──(kali㉿kali)-[~/Downloads]
└─$ wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/common.txt
--2023-11-04 17:52:26--  https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/common.txt
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 38086 (37K) [text/plain]
Saving to: ‘common.txt’

common.txt          100%[================>]  37.19K  --.-KB/s    in 0.006s  

2023-11-04 17:52:27 (6.57 MB/s) - ‘common.txt’ saved [38086/38086]

```

Koska testaukset tehdään lokaalisti, virheiden välttämiseksi otin virtuaalikoneesta verkkoyhteyden pois käytöstä. Tämä onnistui klikkaamalla oikealla hiiren painikkeella kahta näytön kuvaa Virtualboxin alalaidasta, ja sitten valitsemalla `connect network adapter`. Testasin vielä nettiyhteyden toimimattomuuden selaamalla Firefoxilla ylen sivuille:

![1.png](images/1.png)

![2.png](images/2.png)

Laitoin kohdekoneen pyörimään yhteen terminaaliin komennolla `./dirfuzt-1`. Avasin toisen terminaalin ja syötin ffuf:iin komennon parametreilla -c colorised, -v verbose, -w wordlist(eli käytettävä sanalista), -u kohteen url. Näiden lähteenä joohoin esitys kohdassa x\), sekä aiempi komento `ffuf` ilman parametreja

```

┌──(kali㉿kali)-[~/Downloads]
└─$ ffuf -c -v -w common.txt -u http://127.0.0.2:8000/FUZZ

```

Tuloksia tuli huima määrä, eikä ffuffaus antanut yhtäkään virhettä:

![3](images/3.png)

Tuloksilla oli paljon yhteisiä ominaisuuksia:

```

[Status: 200, Size: 154, Words: 9, Lines: 10, Duration: 11ms]
[Status: 200, Size: 154, Words: 9, Lines: 10, Duration: 11ms]
[Status: 200, Size: 154, Words: 9, Lines: 10, Duration: 11ms]
jne.

```

Seuraavaksi kokeilin filtteröidä koon mukaan. joohoin esityksessä oli annettu koon perusteella filtteröintiin -fs parametri, joten syötin sen komentoon lisäksi. Nyt tuloksia tuli huomattavasti pienempi määrä:

```
┌──(kali㉿kali)-[~/Downloads]
└─$ ffuf -c -v -w common.txt -u http://127.0.0.2:8000/FUZZ -fs 154

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://127.0.0.2:8000/FUZZ
 :: Wordlist         : FUZZ: /home/kali/Downloads/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response size: 154
________________________________________________

[Status: 200, Size: 178, Words: 6, Lines: 11, Duration: 4ms]
| URL | http://127.0.0.2:8000/.git/logs/
    * FUZZ: .git/logs/

[Status: 200, Size: 178, Words: 6, Lines: 11, Duration: 4ms]
| URL | http://127.0.0.2:8000/.git/index
    * FUZZ: .git/index

[Status: 200, Size: 178, Words: 6, Lines: 11, Duration: 4ms]
| URL | http://127.0.0.2:8000/.git/config
    * FUZZ: .git/config

[Status: 200, Size: 178, Words: 6, Lines: 11, Duration: 4ms]
| URL | http://127.0.0.2:8000/.git/HEAD
    * FUZZ: .git/HEAD

[Status: 301, Size: 41, Words: 3, Lines: 3, Duration: 4ms]
| URL | http://127.0.0.2:8000/.git
| --> | /.git/
    * FUZZ: .git

:: Progress: [2074/4723] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::: Progress: [3213/4723] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 :[Status: 301, Size: 64, Words: 3, Lines: 3, Duration: 1ms]
| URL | http://127.0.0.2:8000/render/https://www.google.com
| --> | /render/https:/www.google.com
    * FUZZ: render/https://www.google.com

:: Progress: [3517/4723] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::: Progress: [3979/4723] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 :[Status: 200, Size: 182, Words: 6, Lines: 11, Duration: 0ms]
| URL | http://127.0.0.2:8000/wp-admin
    * FUZZ: wp-admin

:: Progress: [4582/4723] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::: Progress: [4723/4723] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::: Progress: [4723/4723] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::


```

Curlasin vielä tuon mielenkiintoiselta kuulostavan wp-admin -hakemiston:

```

┌──(kali㉿kali)-[~/Downloads]
└─$ curl http://127.0.0.2:8000/wp-admin
<!doctype html>
<html>
        <head>
                <title>You found it!</title>
        </head>
        <body>
                <h1>You found it!</h1>
                <p>FLAG{tero-wpadmin-3364c855a2ac87341fc7bcbda955b580}</p>
        </body>
</html>

```

Löysin lipun, hurraa! Kiinnostamaan jäi, onko harjoitusmaalissa muitakin fuzzattavia lippuja, mutta en raportoi niistä tähän.

---

#### b\) Fuffme. Asenna [Ffufme harjoitusmaali](https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian/) paikallisesti omalle koneellesi. Ratkaise tehtävät (kaikki paitsi ei "Content Discovery - Pipes")

Noudatin sivustolla olevia ohjeita harjoitusmaalin asentamiseen [https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian/](https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian/). Epähuomiossa asensin harjoitusmaalin Downloads-hakemiston alle, katsotaan seuraako siitä ongelmia (kotihakemisto on oletuksena paras paikka asentaa asioita). Lataamisten jälkeen suljin taas verkkoyhteyden kuten kohdassa a/).

```

┌──(kali㉿kali)-[~/Downloads]
└─$ sudo apt-get install docker.io git ffuf

```

ffuf oli jo asennettu, mutta komennon `$ sudo apt-get install docker.io git ffuf` ajaminen tuotti mm. seuraavien kirjastojen lataamisen:

```

The following NEW packages will be installed:
  cgroupfs-mount containerd criu docker.io libintl-perl libintl-xs-perl
  libmodule-find-perl libmodule-scandeps-perl libproc-processtable-perl
  libsort-naturally-perl needrestart runc tini

┌──(kali㉿kali)-[~/Downloads]
└─$ git clone https://github.com/adamtlangley/ffufme

┌──(kali㉿kali)-[~/Downloads]
└─$ cd ffufme          

┌──(kali㉿kali)-[~/Downloads/ffufme]
└─$ sudo docker build -t ffufme .

┌──(kali㉿kali)-[~/Downloads/ffufme]
└─$ sudo docker run -d -p 80:80 ffufme
82a274ae55134c4a824abf43715ed7d74006aab0f9774b42be5e051fe656be11
                                                                             
┌──(kali㉿kali)-[~/Downloads/ffufme]
└─$ curl localhost
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FFUF.me</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/MockTerminal/style.css">
    <script src="/MockTerminal/script.js"></script>
    <script src="/script.js"></script>
</head>
<body>
<div class="content">
    <h1><a href="/">FFUF.me</a></h1>    <h2 style="margin: 0;padding: 0">For FFUF Target Practice</h2>
    <div class="text-center"><a href="/about">About</a> | <a href="/help">Help</a> | <a href="/credits">Credits</a></div>
    <div class="welcome text-center" style="margin-top:20px;background-color: #e76c6c">
        <p>Before you start make sure you download the required <a href="/wordlists">wordlists</a> first</p>
    </div>

    <h3>Installation Instructions</h3>
    <ul>
        <li><a href="/install">How To Install</a></li>
    </ul>

    <h3>Content Discovery</h3>
    <ul>
        <li><a href="/cd/basic">Basic Content Discovery</a></li>
        <li><a href="/cd/recursion">Content Discovery With Recursion</a></li>
        <li><a href="/cd/ext">Content Discovery With File Extensions</a></li>
        <li><a href="/cd/no404">No 404 Status</a></li>
        <li><a href="/cd/param">Param Mining</a></li>
        <li><a href="/cd/rate">Rate Limited</a></li>
        <li><a href="/cd/pipes">Pipes</a></li>
    </ul>
    <h3>Subdmain Enumeration</h3>
    <ul>
        <li><a href="/sub/vhost">Virtual Host Discovery</a></li>
    </ul>
</div>
</body>
</html>                                                                             


```

![4](images/4.png)

Ennen aloittamista pyydettiin lataamaan tarvittavat sanalistat kotihakemistoon tehtävään ~/wordlists -hakemistoon. Linkitetyssä sivussa annettiin ohjeet:

```

cd ~
mkdir wordlists
cd wordlists
wget http://localhost/wordlist/common.txt
wget http://localhost/wordlist/parameters.txt
wget http://localhost/wordlist/subdomains.txt

```

##### Tein nämä, ja siirryin kohtaan Basic content discovery:

![5](images/5.png)

```

┌──(kali㉿kali)-[~]
└─$ ffuf -w ~/wordlists/common.txt -u http://localhost/cd/basic/FUZZ

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://localhost/cd/basic/FUZZ
 :: Wordlist         : FUZZ: /home/kali/wordlists/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

:: Progress: [40/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::: Progress: [184/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 :: Progress: [374/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 :: Progress: [560/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 :: Progress: [727/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 :: Progress: [902/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 :: Progress: [1092/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0class                   [Status: 200, Size: 19, Words: 4, Lines: 1, Duration: 29ms]
:: Progress: [1126/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0:: Progress: [1265/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0:: Progress: [1448/4686] :: Job [1/1] :: 1470 req/sec :: Duration: [0:00:01] :: Errorsdevelopment.log         [Status: 200, Size: 19, Words: 4, Lines: 1, Duration: 23ms]
:: Progress: [1478/4686] :: Job [1/1] :: 1470 req/sec :: Duration: [0:00:01] :: Errors:: Progress: [1601/4686] :: Job [1/1] :: 1333 req/sec :: Duration: [0:00:01] :: Errors:: Progress: [1779/4686] :: Job [1/1] :: 1360 req/sec :: Duration: [0:00:01] :: Errors:: Progress: [1958/4686] :: Job [1/1] :: 1459 req/sec :: Duration: [0:00:01] :: Errors:: Progress: [2105/4686] :: Job [1/1] :: 1257 req/sec :: Duration: [0:00:01] :: Errors:: Progress: [2220/4686] :: Job [1/1] :: 1010 req/sec :: Duration: [0:00:01] :: Errors:: Progress: [2393/4686] :: Job [1/1] :: 1408 req/sec :: Duration: [0:00:01] :: Errors:: Progress: [2569/4686] :: Job [1/1] :: 1438 req/sec :: Duration: [0:00:01] :: Errors:: Progress: [2745/4686] :: Job [1/1] :: 1388 req/sec :: Duration: [0:00:02] :: Errors:: Progress: [2936/4686] :: Job [1/1] :: 1550 req/sec :: Duration: [0:00:02] :: Errors:: Progress: [3118/4686] :: Job [1/1] :: 1449 req/sec :: Duration: [0:00:02] :: Errors:: Progress: [3289/4686] :: Job [1/1] :: 1428 req/sec :: Duration: [0:00:02] :: Errors:: Progress: [3441/4686] :: Job [1/1] :: 1257 req/sec :: Duration: [0:00:02] :: Errors:: Progress: [3613/4686] :: Job [1/1] :: 1257 req/sec :: Duration: [0:00:02] :: Errors:: Progress: [3784/4686] :: Job [1/1] :: 1408 req/sec :: Duration: [0:00:02] :: Errors:: Progress: [3961/4686] :: Job [1/1] :: 1459 req/sec :: Duration: [0:00:02] :: Errors:: Progress: [4103/4686] :: Job [1/1] :: 1226 req/sec :: Duration: [0:00:03] :: Errors:: Progress: [4282/4686] :: Job [1/1] :: 1408 req/sec :: Duration: [0:00:03] :: Errors:: Progress: [4469/4686] :: Job [1/1] :: 1503 req/sec :: Duration: [0:00:03] :: Errors:: Progress: [4657/4686] :: Job [1/1] :: 1515 req/sec :: Duration: [0:00:03] :: Errors:: Progress: [4686/4686] :: Job [1/1] :: 1574 req/sec :: Duration: [0:00:03] :: Errors:: Progress: [4686/4686] :: Job [1/1] :: 1574 req/sec :: Duration: [0:00:03] :: Errors: 0 ::

```

"This should of discovered the files class and development.log" Huomioimatta yleistä englannin kieliopillista virhettä (should of -> should have) tuloksista löytyivät pyydetyt asiat

```

class                   [Status: 200, Size: 19, Words: 4, Lines: 1, Duration: 29ms]
development.log         [Status: 200, Size: 19, Words: 4, Lines: 1, Duration: 23ms]

```

##### Recursion

![6](images/6.png)

Annettu komento antoi tuloksissaan pyydetyt asiat. Haussa kesti huomattavasti pidempään (n. 3s per alihakemisto). Rekursiivisuudesta varoitettiinkin, että se hidastaa fuzzauksia huomattavasti.

```

admin                   [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 30ms]
:: Progress: [549/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 
[INFO] Adding a new job to the queue: http://localhost/cd/recursion/admin/FUZZ

[...]

[INFO] Starting queued job on target: http://localhost/cd/recursion/admin/FUZZ

[...]

users                   [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 24ms]
:: Progress: [4351/4686] :: Job [2/2] :: 1515 req/sec :: Duration: [0:00:03] :: Errors
[INFO] Adding a new job to the queue: http://localhost/cd/recursion/admin/users/FUZZ

[...]

[INFO] Starting queued job on target: http://localhost/cd/recursion/admin/users/FUZZ

[...]

96                      [Status: 200, Size: 19, Words: 4, Lines: 1, Duration: 29ms]

[...]

```

##### Content Discovery - File Extensions

![](images/7.png)

```

┌──(kali㉿kali)-[~]
└─$ ffuf -w ~/wordlists/common.txt -e .log -u http://localhost/cd/ext/logs/FUZZ

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://localhost/cd/ext/logs/FUZZ
 :: Wordlist         : FUZZ: /home/kali/wordlists/common.txt
 :: Extensions       : .log 
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

[...]
users.log               [Status: 200, Size: 19, Words: 4, Lines: 1, Duration: 29ms]
[...]

```

##### Content Discovery - No 404 Status

![8](images/8.png)

`ffuf -w ~/wordlists/common.txt -u http://localhost/cd/no404/FUZZ` antoi aivan liikaa dataa läpikäytäväksi, joten laitettiin annettu filtteri:

```

┌──(kali㉿kali)-[~]
└─$ ffuf -w ~/wordlists/common.txt -u http://localhost/cd/no404/FUZZ -fs 669

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://localhost/cd/no404/FUZZ
 :: Wordlist         : FUZZ: /home/kali/wordlists/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response size: 669
________________________________________________

:: Progress: [40/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 :

[...]

secret                  [Status: 200, Size: 25, Words: 4, Lines: 1, Duration: 27ms]

[...]

:: Progress: [4686/4686] :: Job [1/1] :: 1626 req/sec :: Duration: [0:00:03] :: Errors: 0 ::

```

##### Content Discovery - Param Mining

![](images/9.png9.png)

Koska toistuva copypaste komennoille alkoi kyllästyttämään, lisäsin huvikseen parametreihin -c colorised ja -v verbose:

![](images/10.png)

Tämä lisäsi kohtaan Status kivan vihertävän värin, ja muutti tuloksen tulostusta:

```

[Status: 200, Size: 24, Words: 3, Lines: 1, Duration: 7ms]
| URL | http://localhost/cd/param/data?debug=1
    * FUZZ: debug


```

Tuloste kertoi aavistuksen selkeämmin, että kohta FUZZ tilalle oli vaihdettu sana debug sanalistasta.

##### Content Discovery - Rate Limited


![](images/11.png)

Ensimmäinen komento antoi pelkkää virhettä:

```

┌──(kali㉿kali)-[~]
└─$ ffuf -w ~/wordlists/common.txt -u http://ffuf.test/cd/rate/FUZZ -mc 200,429

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://ffuf.test/cd/rate/FUZZ
 :: Wordlist         : FUZZ: /home/kali/wordlists/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,429
________________________________________________

:: Progress: [4686/4686] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 4686 ::
                                                                                            

```

Toinen komento lisäsi 0,1s viivettä ja käynnisti viisi instanssia ffuf:sta. Tämä hidasti tulosten läpikäymistä huomattavasti:

```

┌──(kali㉿kali)-[~]
└─$ ffuf -w ~/wordlists/common.txt -t 5 -p 0.1 -u http://ffuf.test/cd/rate/FUZZ -mc 200,429

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://ffuf.test/cd/rate/FUZZ
 :: Wordlist         : FUZZ: /home/kali/wordlists/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 5
 :: Delay            : 0.10 seconds
 :: Matcher          : Response status: 200,429
________________________________________________

:: Progress: [1000/4686] :: Job [1/1] :: 61 req/sec :: Duration: [0:00:20] :: Errors: 1000 :

[...]

:: Progress: [4686/4686] :: Job [1/1] :: 49 req/sec :: Duration: [0:01:35] :: Errors: 4686 ::


```

Haku kesti 1min 35sek, mutta tuotti myös pelkästään virhetilanteita. Annettua maalia ei löytynyt. Tämä johtunee siitä, että vastoin edellisten tehtävien ohjeistuksia, tässä tehtävässä urlina annetaan ffuf.test localhostin sijaan. Vaihdoin osoitteeksi localhostin, ja sain pyydetyn tuloksen. En tiedä johtuuko tämä siitä, että käytän Kali Linuxia?

```

┌──(kali㉿kali)-[~]
└─$ ffuf -c -v -w ~/wordlists/common.txt -t 5 -p 0.1 -u http://localhost/cd/rate/FUZZ -mc 200,429

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://localhost/cd/rate/FUZZ
 :: Wordlist         : FUZZ: /home/kali/wordlists/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 5
 :: Delay            : 0.10 seconds
 :: Matcher          : Response status: 200,429
________________________________________________

[Status: 200, Size: 19, Words: 4, Lines: 1, Duration: 1ms]
| URL | http://localhost/cd/rate/oracle
    * FUZZ: oracle

:: Progress: [4686/4686] :: Job [1/1] :: 50 req/sec :: Duration: [0:01:36] :: Errors: 0 ::
                                                                                               
```

##### Subdomains - Virtual Host Enumeration

![12](images/12.png)

`ffuf -w ~/wordlists/subdomains.txt -H "Host: FUZZ.ffuf.me" -u http://localhost` antoi 1907 tulosta.

Koon perusteella filtteröinti antoi seuraavan tuloksen:

```
┌──(kali㉿kali)-[~]
└─$ ffuf -w ~/wordlists/subdomains.txt -H "Host: FUZZ.ffuf.me" -u http://localhost -fs 1495

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://localhost
 :: Wordlist         : FUZZ: /home/kali/wordlists/subdomains.txt
 :: Header           : Host: FUZZ.ffuf.me
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response size: 1495
________________________________________________

redhat                  [Status: 200, Size: 15, Words: 2, Lines: 1, Duration: 2ms]
:: Progress: [1907/1907] :: Job [1/1] :: 1190 req/sec :: Duration: [0:00:01] :: Errors: 0 ::
                                                                                                   
```

Filtteröimällä ulos 1495 tavun (byte) vastaukset, jäljelle jäi redhat, jonka koko oli 15 tavua.

---

#### Porttiskannaa paikallinen kone (127.0.0.2 tms), sieppaa liikenne snifferillä, analysoi.

Määritin varmuuden vuoksi käyttäjäni Wiresharkin sallittujen liikenteenkaappaajien joukkoon:

``` 

┌──(kali㉿kali)-[~]
└─$ sudo adduser $(whoami) wireshark # log out, log back
info: The user `kali' is already a member of `wireshark'.

```

Selvitin osoitteeni komennolla `ip addr` ja sain sieltä tiedon eth0 kohdasta: osoitteeni oli 10.0.2.12
Ilmeisesti käyttäjä oli jo tuolla listalla. Käynnistin Wiresharkin ennen testauksia ja jätin sen tallentamaan portin eth0 liikennettä:

![](images/13.png)

#####    c) nmap TCP connect scan -sT

Parametri -sT eli TCP connect scan muodostaa TCP-yhteyden

```
┌──(kali㉿kali)-[~]
└─$ sudo nmap -sT 10.0.2.12   
[sudo] password for kali: 
Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-04 19:52 EET
Nmap scan report for 10.0.2.12
Host is up (0.00011s latency).
Not shown: 999 closed tcp ports (conn-refused)
PORT   STATE SERVICE
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 6.58 seconds


```

![14](images/14.png)

Portti 80 oli auki. Wiresharkkiin ilmestyi välittömästi nmapin käytön jälkeen DNS-protokollaa käyttävä pyyntö kohteelle 4.4.4.4



#####    d) nmap TCP SYN "used to be stealth" scan, -sS (tätä käytetään skannatessa useimmin)

```

┌──(kali㉿kali)-[~]
└─$ sudo nmap -v -sS 10.0.2.12
Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-04 20:01 EET
Initiating Parallel DNS resolution of 1 host. at 20:01
Completed Parallel DNS resolution of 1 host. at 20:01, 6.52s elapsed
Initiating SYN Stealth Scan at 20:01
Scanning 10.0.2.12 [1000 ports]
Completed SYN Stealth Scan at 20:01, 1.22s elapsed (1000 total ports)
Nmap scan report for 10.0.2.12
Host is up (0.0000040s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE    SERVICE
80/tcp filtered http

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 7.77 seconds
           Raw packets sent: 1001 (44.044KB) | Rcvd: 1998 (83.916KB)

```

Nmap antoi portin tilaksi filtered. Wiresharkin tulokset vaikuttivat hyvin samanlaisilta, enkä löytänyt niistä eroavaisuuksia. Olisin odottanut, että c-kohdan skannus olisi sisältänyt ACK-pakettia ennen SYN-ACK-paketin, mutta en sitä havainnut Wiresharkista (tai en osannut sitä lukea, käyttöliittymä on lievästi sanottuna täynnä tavaraa). Lisäsin parametrin -v verbose, josko sen tuloksista tulisi uutta tietoa. Nmapinkin mukaan tehdään DNS-pyyntöjä.

#####    e) nmap ping sweep -sn

```

┌──(kali㉿kali)-[~]
└─$ sudo nmap -sn 10.0.2.12
Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-04 20:08 EET
Nmap scan report for 10.0.2.12
Host is up.
Nmap done: 1 IP address (1 host up) scanned in 6.52 seconds

```

nmapin tulos oli tällä kertaa selvästi eroavainen, se selvitti vain onko hosti ylhäällä.

![](images/15.png)

Jäi hyvin epäselväksi Wiresharkista, että miten nämä kolme ensimmäistä skannausta eroavat toisistaan. Joka kerralla tulokset ovat olleet lähes identtiset. Ehkä pakettien tiedoissa olisi joitakin eroavaisuuksia?

#####    f) nmap don't ping -Pn

```

┌──(kali㉿kali)-[~]
└─$ sudo nmap -Pn 10.0.2.12
Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-04 20:13 EET
Nmap scan report for 10.0.2.12
Host is up (0.000010s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE    SERVICE
80/tcp filtered http

Nmap done: 1 IP address (1 host up) scanned in 7.78 seconds

```

Taas kerran tulokset ovat hyvin samankaltaiset, enkä löydä eroavaisuuksia esim. -sS ja -Pn väliltä Wiresharkissa. 

#####    g) nmap version detection -sV (esimerkki yhdestä palvelusta yhdessä portissa riittää)

Suljin aiemmin avatun dockerin `sudo docker stop agitated_johnson` ja potkaisin apachen käyntiin `sudo systemctl restart apache2.service`

```

┌──(kali㉿kali)-[~]
└─$ sudo nmap -p 80 -sV 10.0.2.12
Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-04 20:23 EET
Nmap scan report for 10.0.2.12
Host is up (0.000052s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.58 ((Debian))

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.75 seconds

```

Nyt portin tila vaihtui filtteröidystä avoimeksi, ja versiotiedoksi saatiin Apachen tiedot. Ajoin myös kokeeksi -sS parametrin

```

┌──(kali㉿kali)-[~]
└─$ sudo nmap -p 80 -sS 10.0.2.12
Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-04 20:26 EET
Nmap scan report for 10.0.2.12
Host is up (0.000046s latency).

PORT   STATE SERVICE
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 6.57 seconds

```

Nyt -sS antoi portin avoimena. Eroavaisuus -sV parametriin on version puuttuminen ja selvästi lyhyempi aika. Wiresharkin tuloksista en taaskaan osannut tulkita vahvoja eroavaisuuksia

#####    h) nmap output files -oA foo. Miltä tiedostot näyttävät? Mihin kukin tiedostotyyppi sopii?

-oA vie nmapin tiedot tiedostoon. Nähtävästi tiedostoja syntyi kolme. *.gnmap, *.nmap ja *.xml

```

┌──(kali㉿kali)-[~]
└─$ sudo nmap -sS 10.0.2.12 -oA foo
Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-04 20:30 EET
Nmap scan report for 10.0.2.12
Host is up (0.0000040s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 6.59 seconds
                                                                                                             
┌──(kali㉿kali)-[~]
└─$ ls
Desktop    Downloads  Pictures  Templates  foo.gnmap  foo.xml      wordlists
Documents  Music      Public    Videos     foo.nmap   public_html


┌──(kali㉿kali)-[~]
└─$ cat foo.gnmap                      
# Nmap 7.94 scan initiated Sat Nov  4 20:30:25 2023 as: nmap -sS -oA foo 10.0.2.12
Host: 10.0.2.12 ()      Status: Up
Host: 10.0.2.12 ()      Ports: 80/open/tcp//http///     Ignored State: closed (999)
# Nmap done at Sat Nov  4 20:30:32 2023 -- 1 IP address (1 host up) scanned in 6.59 seconds
                                                                                                 

┌──(kali㉿kali)-[~]
└─$ cat foo.nmap 
# Nmap 7.94 scan initiated Sat Nov  4 20:30:25 2023 as: nmap -sS -oA foo 10.0.2.12
Nmap scan report for 10.0.2.12
Host is up (0.0000040s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE
80/tcp open  http

# Nmap done at Sat Nov  4 20:30:32 2023 -- 1 IP address (1 host up) scanned in 6.59 seconds


┌──(kali㉿kali)-[~]
└─$ cat foo.xml 
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE nmaprun>
<?xml-stylesheet href="file:///usr/bin/../share/nmap/nmap.xsl" type="text/xsl"?>
<!-- Nmap 7.94 scan initiated Sat Nov  4 20:30:25 2023 as: nmap -sS -oA foo 10.0.2.12 -->
<nmaprun scanner="nmap" args="nmap -sS -oA foo 10.0.2.12" start="1699122625" startstr="Sat Nov  4 20:30:25 2023" version="7.94" xmloutputversion="1.05">
<scaninfo type="syn" protocol="tcp" numservices="1000" services="1,3-4,6-7,9,13,17,19-26,30,32-33,37,42-43,49,53,70,79-85,88-90,99-100,106,109-111,113,119,125,135,139,143-144,146,161,163,179,199,211-212,222,254-256,259,264,280,301,306,311,340,366,389,406-407,416-417,425,427,443-445,458,464-465,481,497,500,512-515,524,541,543-545,548,554-555,563,587,593,616-617,625,631,636,646,648,666-668,683,687,691,700,705,711,714,720,722,726,749,765,777,783,787,800-801,808,843,873,880,888,898,900-903,911-912,981,987,990,992-993,995,999-1002,1007,1009-1011,1021-1100,1102,1104-1108,1110-1114,1117,1119,1121-1124,1126,1130-1132,1137-1138,1141,1145,1147-1149,1151-1152,1154,1163-1166,1169,1174-1175,1183,1185-1187,1192,1198-1199,1201,1213,1216-1218,1233-1234,1236,1244,1247-1248,1259,1271-1272,1277,1287,1296,1300-1301,1309-1311,1322,1328,1334,1352,1417,1433-1434,1443,1455,1461,1494,1500-1501,1503,1521,1524,1533,1556,1580,1583,1594,1600,1641,1658,1666,1687-1688,1700,1717-1721,1723,1755,1761,1782-1783,1801,1805,1812,1839-1840,1862-1864,1875,1900,1914,1935,1947,1971-1972,1974,1984,1998-2010,2013,2020-2022,2030,2033-2035,2038,2040-2043,2045-2049,2065,2068,2099-2100,2103,2105-2107,2111,2119,2121,2126,2135,2144,2160-2161,2170,2179,2190-2191,2196,2200,2222,2251,2260,2288,2301,2323,2366,2381-2383,2393-2394,2399,2401,2492,2500,2522,2525,2557,2601-2602,2604-2605,2607-2608,2638,2701-2702,2710,2717-2718,2725,2800,2809,2811,2869,2875,2909-2910,2920,2967-2968,2998,3000-3001,3003,3005-3007,3011,3013,3017,3030-3031,3052,3071,3077,3128,3168,3211,3221,3260-3261,3268-3269,3283,3300-3301,3306,3322-3325,3333,3351,3367,3369-3372,3389-3390,3404,3476,3493,3517,3527,3546,3551,3580,3659,3689-3690,3703,3737,3766,3784,3800-3801,3809,3814,3826-3828,3851,3869,3871,3878,3880,3889,3905,3914,3918,3920,3945,3971,3986,3995,3998,4000-4006,4045,4111,4125-4126,4129,4224,4242,4279,4321,4343,4443-4446,4449,4550,4567,4662,4848,4899-4900,4998,5000-5004,5009,5030,5033,5050-5051,5054,5060-5061,5080,5087,5100-5102,5120,5190,5200,5214,5221-5222,5225-5226,5269,5280,5298,5357,5405,5414,5431-5432,5440,5500,5510,5544,5550,5555,5560,5566,5631,5633,5666,5678-5679,5718,5730,5800-5802,5810-5811,5815,5822,5825,5850,5859,5862,5877,5900-5904,5906-5907,5910-5911,5915,5922,5925,5950,5952,5959-5963,5987-5989,5998-6007,6009,6025,6059,6100-6101,6106,6112,6123,6129,6156,6346,6389,6502,6510,6543,6547,6565-6567,6580,6646,6666-6669,6689,6692,6699,6779,6788-6789,6792,6839,6881,6901,6969,7000-7002,7004,7007,7019,7025,7070,7100,7103,7106,7200-7201,7402,7435,7443,7496,7512,7625,7627,7676,7741,7777-7778,7800,7911,7920-7921,7937-7938,7999-8002,8007-8011,8021-8022,8031,8042,8045,8080-8090,8093,8099-8100,8180-8181,8192-8194,8200,8222,8254,8290-8292,8300,8333,8383,8400,8402,8443,8500,8600,8649,8651-8652,8654,8701,8800,8873,8888,8899,8994,9000-9003,9009-9011,9040,9050,9071,9080-9081,9090-9091,9099-9103,9110-9111,9200,9207,9220,9290,9415,9418,9485,9500,9502-9503,9535,9575,9593-9595,9618,9666,9876-9878,9898,9900,9917,9929,9943-9944,9968,9998-10004,10009-10010,10012,10024-10025,10082,10180,10215,10243,10566,10616-10617,10621,10626,10628-10629,10778,11110-11111,11967,12000,12174,12265,12345,13456,13722,13782-13783,14000,14238,14441-14442,15000,15002-15004,15660,15742,16000-16001,16012,16016,16018,16080,16113,16992-16993,17877,17988,18040,18101,18988,19101,19283,19315,19350,19780,19801,19842,20000,20005,20031,20221-20222,20828,21571,22939,23502,24444,24800,25734-25735,26214,27000,27352-27353,27355-27356,27715,28201,30000,30718,30951,31038,31337,32768-32785,33354,33899,34571-34573,35500,38292,40193,40911,41511,42510,44176,44442-44443,44501,45100,48080,49152-49161,49163,49165,49167,49175-49176,49400,49999-50003,50006,50300,50389,50500,50636,50800,51103,51493,52673,52822,52848,52869,54045,54328,55055-55056,55555,55600,56737-56738,57294,57797,58080,60020,60443,61532,61900,62078,63331,64623,64680,65000,65129,65389"/>
<verbose level="0"/>
<debugging level="0"/>
<host starttime="1699122632" endtime="1699122632"><status state="up" reason="localhost-response" reason_ttl="0"/>
<address addr="10.0.2.12" addrtype="ipv4"/>
<hostnames>
</hostnames>
<ports><extraports state="closed" count="999">
<extrareasons reason="reset" count="999" proto="tcp" ports="1,3-4,6-7,9,13,17,19-26,30,32-33,37,42-43,49,53,70,79,81-85,88-90,99-100,106,109-111,113,119,125,135,139,143-144,146,161,163,179,199,211-212,222,254-256,259,264,280,301,306,311,340,366,389,406-407,416-417,425,427,443-445,458,464-465,481,497,500,512-515,524,541,543-545,548,554-555,563,587,593,616-617,625,631,636,646,648,666-668,683,687,691,700,705,711,714,720,722,726,749,765,777,783,787,800-801,808,843,873,880,888,898,900-903,911-912,981,987,990,992-993,995,999-1002,1007,1009-1011,1021-1100,1102,1104-1108,1110-1114,1117,1119,1121-1124,1126,1130-1132,1137-1138,1141,1145,1147-1149,1151-1152,1154,1163-1166,1169,1174-1175,1183,1185-1187,1192,1198-1199,1201,1213,1216-1218,1233-1234,1236,1244,1247-1248,1259,1271-1272,1277,1287,1296,1300-1301,1309-1311,1322,1328,1334,1352,1417,1433-1434,1443,1455,1461,1494,1500-1501,1503,1521,1524,1533,1556,1580,1583,1594,1600,1641,1658,1666,1687-1688,1700,1717-1721,1723,1755,1761,1782-1783,1801,1805,1812,1839-1840,1862-1864,1875,1900,1914,1935,1947,1971-1972,1974,1984,1998-2010,2013,2020-2022,2030,2033-2035,2038,2040-2043,2045-2049,2065,2068,2099-2100,2103,2105-2107,2111,2119,2121,2126,2135,2144,2160-2161,2170,2179,2190-2191,2196,2200,2222,2251,2260,2288,2301,2323,2366,2381-2383,2393-2394,2399,2401,2492,2500,2522,2525,2557,2601-2602,2604-2605,2607-2608,2638,2701-2702,2710,2717-2718,2725,2800,2809,2811,2869,2875,2909-2910,2920,2967-2968,2998,3000-3001,3003,3005-3007,3011,3013,3017,3030-3031,3052,3071,3077,3128,3168,3211,3221,3260-3261,3268-3269,3283,3300-3301,3306,3322-3325,3333,3351,3367,3369-3372,3389-3390,3404,3476,3493,3517,3527,3546,3551,3580,3659,3689-3690,3703,3737,3766,3784,3800-3801,3809,3814,3826-3828,3851,3869,3871,3878,3880,3889,3905,3914,3918,3920,3945,3971,3986,3995,3998,4000-4006,4045,4111,4125-4126,4129,4224,4242,4279,4321,4343,4443-4446,4449,4550,4567,4662,4848,4899-4900,4998,5000-5004,5009,5030,5033,5050-5051,5054,5060-5061,5080,5087,5100-5102,5120,5190,5200,5214,5221-5222,5225-5226,5269,5280,5298,5357,5405,5414,5431-5432,5440,5500,5510,5544,5550,5555,5560,5566,5631,5633,5666,5678-5679,5718,5730,5800-5802,5810-5811,5815,5822,5825,5850,5859,5862,5877,5900-5904,5906-5907,5910-5911,5915,5922,5925,5950,5952,5959-5963,5987-5989,5998-6007,6009,6025,6059,6100-6101,6106,6112,6123,6129,6156,6346,6389,6502,6510,6543,6547,6565-6567,6580,6646,6666-6669,6689,6692,6699,6779,6788-6789,6792,6839,6881,6901,6969,7000-7002,7004,7007,7019,7025,7070,7100,7103,7106,7200-7201,7402,7435,7443,7496,7512,7625,7627,7676,7741,7777-7778,7800,7911,7920-7921,7937-7938,7999-8002,8007-8011,8021-8022,8031,8042,8045,8080-8090,8093,8099-8100,8180-8181,8192-8194,8200,8222,8254,8290-8292,8300,8333,8383,8400,8402,8443,8500,8600,8649,8651-8652,8654,8701,8800,8873,8888,8899,8994,9000-9003,9009-9011,9040,9050,9071,9080-9081,9090-9091,9099-9103,9110-9111,9200,9207,9220,9290,9415,9418,9485,9500,9502-9503,9535,9575,9593-9595,9618,9666,9876-9878,9898,9900,9917,9929,9943-9944,9968,9998-10004,10009-10010,10012,10024-10025,10082,10180,10215,10243,10566,10616-10617,10621,10626,10628-10629,10778,11110-11111,11967,12000,12174,12265,12345,13456,13722,13782-13783,14000,14238,14441-14442,15000,15002-15004,15660,15742,16000-16001,16012,16016,16018,16080,16113,16992-16993,17877,17988,18040,18101,18988,19101,19283,19315,19350,19780,19801,19842,20000,20005,20031,20221-20222,20828,21571,22939,23502,24444,24800,25734-25735,26214,27000,27352-27353,27355-27356,27715,28201,30000,30718,30951,31038,31337,32768-32785,33354,33899,34571-34573,35500,38292,40193,40911,41511,42510,44176,44442-44443,44501,45100,48080,49152-49161,49163,49165,49167,49175-49176,49400,49999-50003,50006,50300,50389,50500,50636,50800,51103,51493,52673,52822,52848,52869,54045,54328,55055-55056,55555,55600,56737-56738,57294,57797,58080,60020,60443,61532,61900,62078,63331,64623,64680,65000,65129,65389"/>
</extraports>
<port protocol="tcp" portid="80"><state state="open" reason="syn-ack" reason_ttl="64"/><service name="http" method="table" conf="3"/></port>
</ports>
<times srtt="4" rttvar="0" to="100000"/>
</host>
<runstats><finished time="1699122632" timestr="Sat Nov  4 20:30:32 2023" summary="Nmap done at Sat Nov  4 20:30:32 2023; 1 IP address (1 host up) scanned in 6.59 seconds" elapsed="6.59" exit="success"/><hosts up="1" down="0" total="1"/>
</runstats>
</nmaprun>
                                                                   
```

.gnmap oli tiedoiltaan suppein, ja helpoiten silmäiltävä. .nmap oli aavistuksen laajempi ja ehkä aavistuksen luettavampi. .xml tiedosto sisälsi selvästi laajasti merkittynä kaikki tutkitut portit ja skannauksen debuggaustiedot.



#####    i) nmap ajonaikaiset toiminnot (man nmap: runtime interaction): verbosity v/V, help ?, packet tracing p/P, status s (ja moni muu nappi)

Valitsin tähän aikaavievämmän peruskomennon, versioskannauksen kaikille porteille. Tämä siksi, että ehdin kokeilla nappeja. v:tä painelemalla tapahtui seuraavaa:

```

┌──(kali㉿kali)-[~]
└─$ sudo nmap -sV -p- 10.0.2.12    
Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-04 20:37 EET
Verbosity Increased to 1.
Verbosity Increased to 2.
Verbosity Increased to 3.
Verbosity Increased to 4.
Verbosity Increased to 5.
Verbosity Increased to 6.
Completed Parallel DNS resolution of 1 host. at 20:37, 6.51s elapsed
DNS resolution of 1 IPs took 6.51s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 3, CN: 0]
Initiating SYN Stealth Scan at 20:37
Scanning 10.0.2.12 [65535 ports]
Discovered open port 80/tcp on 10.0.2.12
Verbosity Increased to 7.
Completed SYN Stealth Scan at 20:37, 0.74s elapsed (65535 total ports)
Initiating Service scan at 20:37
Scanning 1 service on 10.0.2.12
Verbosity Increased to 8.
Completed Service scan at 20:37, 6.02s elapsed (1 service on 1 host)
NSE: Script scanning 10.0.2.12.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 20:37
Completed NSE at 20:37, 0.01s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 20:37
Completed NSE at 20:37, 0.01s elapsed
Nmap scan report for 10.0.2.12
Host is up (0.0000040s latency).
Scanned at 2023-11-04 20:37:13 EET for 7s
Not shown: 65534 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.58 ((Debian))

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.54 seconds
           Raw packets sent: 65535 (2.884MB) | Rcvd: 131071 (5.505MB)

```

Ilmeisesti myös -sV hyödyntää "stealth scania"? Verbositeetin kasvattaminen nosti nmapin kerrontaa sen senhetkisistä toiminnoista.


#####    j) Ninjojen tapaan. Piiloutuuko nmap-skannaus hyvin palvelimelta? Vinkkejä: Asenna Apache. Aja nmap-versioskannaus -sV tai -A omaan paikalliseen weppipalvelimeen. Etsi Apachen lokista tätä koskevat rivit. Wiresharkissa "http" on kätevä filtteri, se tulee siihen yläreunan "Apply a display filter..." -kenttään. Nmap-ajon aikana p laittaa packet tracing päälle. Vapaaehtoinen lisäkohta: jääkö Apachen lokiin jokin todiste nmap-versioskannauksesta?

Apache oli jo potkaistu käyntiin kohdassa g\). Apachen lokitiedot ovat hakemistossa /var/log/apache2/access.log. Katsoin viimeisimmät lokitiedot sieltä, ja niissä oli epäilyttävästi GET-pyyntöjä nmapista... Ehkä nmap ei ole kovin hienovarainen etenkään laajempia skannauksia tehtäessä.

```

127.0.0.1 - - [04/Nov/2023:20:45:07 +0200] "GET /favicon.ico HTTP/1.1" 404 451 "-" "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"
127.0.0.1 - - [04/Nov/2023:20:45:07 +0200] "OPTIONS / HTTP/1.1" 200 181 "-" "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"
127.0.0.1 - - [04/Nov/2023:20:45:07 +0200] "GET / HTTP/1.1" 200 10975 "-" "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"
127.0.0.1 - - [04/Nov/2023:20:45:07 +0200] "OPTIONS / HTTP/1.1" 200 181 "-" "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"
127.0.0.1 - - [04/Nov/2023:20:45:07 +0200] "OPTIONS / HTTP/1.1" 200 181 "-" "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"
127.0.0.1 - - [04/Nov/2023:20:45:07 +0200] "OPTIONS / HTTP/1.1" 200 181 "-" "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"
127.0.0.1 - - [04/Nov/2023:20:45:07 +0200] "OPTIONS / HTTP/1.1" 200 181 "-" "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"
127.0.0.1 - - [04/Nov/2023:20:45:07 +0200] "OPTIONS / HTTP/1.1" 200 181 "-" "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"
127.0.0.1 - - [04/Nov/2023:20:45:07 +0200] "OPTIONS / HTTP/1.1" 200 181 "-" "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"


```

#####    k) UDP-skannaus. UDP-skannaa paikkalinen kone (-sU). "Mulla olis vitsi UDP:sta, mutta en tiedä menisikö se perille":

```
┌──(kali㉿kali)-[/var/log/apache2]
└─$ sudo nmap -sU 10.0.2.12    
Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-04 20:53 EET
Nmap scan report for 10.0.2.12
Host is up (0.000025s latency).
All 1000 scanned ports on 10.0.2.12 are in ignored states.
Not shown: 1000 closed udp ports (port-unreach)

Nmap done: 1 IP address (1 host up) scanned in 6.65 seconds

```

Avoimia UDP-portteja ei löytynyt... Ei niitä löytynyt kyllä aiemminkaan laajemmissa skannauksissa.

##### l) Miksi UDP-skannaus on hankalaa ja epäluotettavaa? Miksi UDP-skannauksen kanssa kannattaa käyttää --reason flagia ja snifferiä? (tässä alakohdassa vain vastaus viitteineen, ei tarvita testiä tietokoneella)

[Port Scanning Techniques](https://nmap.org/book/man-port-scanning-techniques.html) kertoi, että UDP-skannaukset ovat hitaita eivätkä ne välttämättä anna selkeitä tuloksia. Hitaudesta seuraa usein timeout. [https://nmap.org/book/port-scanning-options.html](https://nmap.org/book/port-scanning-options.html) kertoo, että --reason flag lisää kolumnin "mielenkiintoisten porttien pöytään" joka kertoo, miksi nmap luokitteli portin tekemällään tavalla. Snifferi antaa myös vastaavalla tavalla tietoja, että onko portti oikeasti missä tilassa, vaikka nmap ei antaisikaan muuta kuin filtered/suljetun tilan.