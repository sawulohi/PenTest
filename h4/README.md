Testaukset tehty Windows 10 käyttöjärjestelmällä, Version 10.0.19045 Build 19045. Tämän lisäksi käytetty myös Kali Linux versio 2023.3 ajettuna VirtualBoxin versio 6.1 kautta,  Prosessorina Intel(R) Core(TM) i7-8700K CPU @ 3.70GHz, 16GB RAM

[https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h4-totally-legit-sertificate](https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h4-totally-legit-sertificate)

#### x\) Lue/katso ja tiivistä. 

  * OWASP 2021: OWASP Top 10:2021

    * A01:2021 – [Broken Access Control (IDOR ja path traversal ovat osa tätä)](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)

      - Vuoden 2021 yleisin tapa jolla tietojärjestelmiin on murtauduttu
      - Access control viittaa käyttäjien mahdollisuuksiin tehdä toimia heille asetettujen sääntöjen ja lupien perusteella
      - Rikkinäinen access control voi antaa käyttäjälle mahdollisuuksia toimia "rajojensa" ulkopuolella
      - Voidaan toteuttaa esim. weppisivun urlin parametreja manipuloimalla, tai korottamalla käyttäjän oikeuksia (esim. normaali käyttäjä -> admin)
      - Estettävissä esim. estämällä käyttöoikeudet kaikkeen muuhun paitsi julkisiin resursseihin, käyttäjäkohtaisten tiedostojen käyttöoikeudet vain niiden tekijälle, disabloi weppiserverin directoryn listaus

    * A10:2021 – [Server-Side Request Forgery (SSRF)](https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/)

      - 2021 10:llä sijalla oleva hyökkäysmuoto
      - Väärentämällä sertifikaatti, hyökkääjä voi manipuloida weppisovelluksen tekemään pyyntöjä odottamattomasta lähteestä
      - Estäminen esim.
        - Verkkotasolla: "deny by default" tulimuureihin, verkkorakenteiden segmentointi
        - Applikaatiotasolla: validoi kaikki syötetty data, estä HTTP uudelleenohjaukset

  * PortSwigger Academy:

    * [Access control vulnerabilities and privilege escalation](https://portswigger.net/web-security/access-control) (IDOR on osa tätä)

      - Weppiapplikaatioiden kontekstissa access control kertoo, onko käyttäjällä oikeus tehdä yritetty toiminto
      - Vertikaalinen access control -mallinnus viittaa käyttäjien ryhmittämiseen roolien perusteella
      - Horisontaalinen taasen viittaa tiettyihin yksittäisiin käyttäjiin
      - Kontekstisidonnainen malli kertoo esim. mahdollisesta järjestyksestä tehdä toimia
      - Mallinnuksien avulla voidaan tarkastella hyökkäyksiä, esim. vertikaalisessa hyökkäyksessä voitaisiin nostaa hallussa olevan käyttäjän oikeuksia ylöspäin

    * [Server-side template injection](https://portswigger.net/web-security/server-side-template-injection)

      - Hyökkäys toimii syöttämällä hyötykuorma templateen, joka ajetaan palvelimella
      - Vähän kuin SQL-injektio, ja saavutettu datakin voi olla samankaltaista tietokannoissa olevaa tietoa, kuten käyttäjänimiä tms.
      - Haavoittuvuus voidaan havaita esim. fuzzaamalla erikoismerkkejä kuten `${{<%[%'"}}%\`
      - Hyökkäys voidaan toteuttaa esim. syöttämällä (urlin) parametreihin koodia
      - Estäminen esim. estämällä käyttäjiltä olemassaolevien templatejen muokkaus/uusien tekeminen

    * [Server-side request forgery (SSRF)](https://portswigger.net/web-security/ssrf)

      - Sisältää keinoja kiertää yleisiä SSRF-puolustuksia
      - Esim. IP-osoitteet voi esittää eriävillä tavoilla, jotka kiertävät yksinkertaisen filtteröinnin (127.0.0.1 -> 2130706433 jne.)
      - SSRF sokkona voi paljastaa piilossa olevaa hyökkäyspinta-alaa esim. virheilmoitusten kautta

    * [Cross-site scripting](https://portswigger.net/web-security/cross-site-scripting)
    
      - XSS on hyökkäys, jossa hyökkääjä käyttää haavoittuvaista weppisivua palauttaakseen uhreilleen haitallista JavaScript-koodia
      - Kolme erilaista XSS-hyökkäystä: Reflected XSS, Stored XSS ja DOM-based XSS
      - Reflected on yksinkertaisin, ja se toimii heti kun selain prosessoi uhrikoneella weppisivun dataa
      - Stored on syötettyä dataa joka sisältää haitallista koodia
      - DOM pohjautuu hyökkääjän mahdollisuuksiin vaikuttaa palautettavaan dataan käyttäjän pyynnöstä

  * Karvinen 2020: [Using New Webgoat 2023.4 to Try Web Hacking](https://terokarvinen.com/2023/webgoat-2023-4-ethical-web-hacking/)
    - Ohjeet Webgoatin uusimman version asennukseen

---

#### a\) Totally Legit Sertificate. Asenna OWASP ZAP, generoi CA-sertifikaatti ja asenna se selaimeesi. Laita ZAP proxyksi selaimeesi. Osoita, että hakupyynnöt ilmestyvät ZAP:n käyttöliittymään. (Ei toimi localhost:lla ilman Foxyproxya)

Käytin tehtävissä a-b) lähteenä [miljonkan läksyraporttia](https://github.com/miljonka/Tunkeutumistestaus/wiki/h2_Totally-Legit-Sertificate)

Asensin ZAPin komennolla `sudo apt-get install zaproxy`. Käynnistin ohjelman komennolla `zaproxy`. ZAP aukesi, ja avasin sieltä Firefoxin painikkeesta. Firefox avautui ja kertoi minulle, että selain proxyttaa liikenteensä ZAPin kautta, ja jättää huomioimatta kaikki sertifikaattipyynnöt.

![](1.png)

Minulla oli apache-palvelin pyörimässä, joten kokeilin yhdistää localhostiin ohjeiden vastaisesti. Yllätyksekseni ZAP tarjosi minulle "HUD"-nimistä palvelua, ja kaappasi verkkoliikennettä jopa localhostista, ja ZAPin oma kierros avautui porttiin 37637. Pyysin ZAPin tarjoamaa opastettua kierrosta:

![](2.png)

```

Obligatory Warning
ZAP is a security tool and therefore by design you can use it to attack web applications.

You should only use ZAP (and therefore also the HUD) on applications that you either own or have permission to attack.

The good news is that if you installed ZAP on your own machine then you do own this tutorial, so let's get started ... 

```

![](3.png)

ZAP sai tietoa esim. painalluksistani kun klikkailin tutoriaalia eteenpäin. Jätin tutoriaalin tutkimisen myöhemmälle, ja siirryin seuraavaan kohtaan.

Avasin ZAPista `Tools -> Options` ja laitoin hakuun "certificate", siirryin kohtaan Server Certificates. Painoin `Generate` ja `Save`. Ohjelma kysyi, haluanko ylikirjoittaa olemassaolevan sertifikaatin, painoin kyllä.

![](5.png)

Siirryin Firefoxin asetuksiin sivustolle `about:preferences` ja laitoin hakupalkkiin "certifi", jolloin löytyi sertifikaateista vastaava asetus:

![](6.png)

Painoin `Import` aukeavasta kohdasta ja lisäsin sertifikaattini kotihakemistostani:

![](7.png)

Ohjelma kysyi pahaenteisesti, että luotanko "Zed Attack Proxyyn", ja luotanhan minä! Varmistin vielä hyväksynnän jälkeen, että sertifikaatti todella näkyi sertifikaattien joukossa:

![](8.png)

---

#### b\) Kettumaista. Asenna FoxyProxy Standard Firefox Addon, ja lisää ZAP proxyksi siihen.

[https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/](https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/) sivustolta sai asennettua FoxyProxyn.

![](9.png)

Asetin FoxyProxyn asetuksiin localhostin proxyksi. Lisäksi aktivoin vielä FoxyProxyn Firefoxin extensions-valikosta

![](10.png)

Tarkistin, että sertifikaattina toimi antamani ZAP Proxy. Ja toimihan se! Myös ZAPin historiasta pystyi tarkastelemaan google.comiin tekemääni testihakua.

![](11.png)

---

#### PortSwigger Labs. Ratkaise tehtävät. Selitä ratkaisusi: mitä palvelimella tapahtuu, mitä eri osat tekevät, miten hyökkäys löytyi, mistä vika johtuu. (Voi käyttää ZAPia, vaikka malliratkaisut käyttävät harjoitusten tekijän maksullista ohjelmaa)

#####    Insecure Direct Object Reference (IDOR)

c\) [Insecure direct object references](https://portswigger.net/web-security/access-control/lab-insecure-direct-object-references)

" This lab stores user chat logs directly on the server's file system, and retrieves them using static URLs.

Solve the lab by finding the password for the user carlos, and logging into their account. "

Avasin Live Chat-sivun ja kirjoitin siihen 'Hello there'. Painoin view transcript-nappia, joka latasi koneelleni 2.txt-tiedoston, joka sisälsi chattini lokit.

![](12.png)

ZAP kertoi, että kun painoin nappia, oikeasti lähetin GET-pyynnön palvelimelle johon minulle vastattiin lähettämällä tiedosto. Tiedoston nimi vihjaa, että chattitiedostoja saattaisi olla myös numerolla 1. Joten kirjoitin urliin saman osoitteen kuin ZAPin antama, mutta vaihdoin numeron 2 tilalle 1. Sain ladattua 1.txt-nimisen tiedoston:

```

CONNECTED: -- Now chatting with Hal Pline --
You: Hi Hal, I think I've forgotten my password and need confirmation that I've got the right one
Hal Pline: Sure, no problem, you seem like a nice guy. Just tell me your password and I'll confirm whether it's correct or not.
You: Wow you're so nice, thanks. I've heard from other people that you can be a right ****
Hal Pline: Takes one to know one
You: Ok so my password is thlca57yuj3vkcqkcvz4. Is that right?
Hal Pline: Yes it is!
You: Ok thanks, bye!
Hal Pline: Do one!

```

Menin kohtaan My Account, ja syötin sinne annetun käyttäjänimen carlos, sekä salasanan thlca57yuj3vkcqkcvz4.

![](13.png)


#####    Path traversal

d\) [File path traversal, simple case](https://portswigger.net/web-security/file-path-traversal/lab-simple)

" This lab contains a path traversal vulnerability in the display of product images.

To solve the lab, retrieve the contents of the /etc/passwd file. "

Aloitin liikenteen pysäyttämisen vihreällä painikkeella ZAPissa ja painoin tuotteen sivustoa. Selain teki pyynnön palvelimelle, jossa se pyysi productid arvolla 1 tietoja. Siirryin vastauskohtaan, ja annoin palautettavan kuvan sijaan filenameksi ../../../etc/passwd. Labra ratkoutui, vaikka en nähnyt varsinaista tiedostoa koskaan.

![](14.png)

e\) [File path traversal, traversal sequences blocked with absolute path bypass](https://portswigger.net/web-security/file-path-traversal/lab-absolute-path-bypass)

" This lab contains a path traversal vulnerability in the display of product images.

The application blocks traversal sequences but treats the supplied filename as being relative to a default working directory.

To solve the lab, retrieve the contents of the /etc/passwd file. "

Kuten edellisessä kohdassa, etsin kaapatusta liikenteestä kohdan jossa palautetaan tiedosto, mutta vaihdoin kuvatiedoston tilalle polun /etc/passwd ja labra suoriutui ilman tiedoston sisällön näkemistä. Tai sitten en sitä osannut etsiä oikeasta kohdasta.. Ymmärrän kyllä teorian hyökkäyksen taustalla, eli kaapattuun liikenteeseen syötetään omaa haittakoodia. Mutta varsinainen data jää näissä labroissa helposti näkemättä.

![](15.png)

f\) [File path traversal, traversal sequences stripped non-recursively](https://portswigger.net/web-security/file-path-traversal/lab-sequences-stripped-non-recursively)

Samoin kuin edellisissä kohdissa, mutta tällä kertaa syötettiin `....//....//....//etc/passwd`

![](16.png)

#####    Server Side Template Injection (SSTI)

g\) [Server-side template injection with information disclosure via user-supplied objects (Tämä on merkitty hieman vaikeammaksi, jätä viimeiseksi jos näyttää hankalalta)](https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-with-information-disclosure-via-user-supplied-objects)

Jätän tämän myöhemmälle ajalle.

#####    Server Side Request Forgery (SSRF)

h\) [Basic SSRF against the local server](https://portswigger.net/web-security/ssrf/lab-basic-ssrf-against-localhost)

" This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos. "

Surffasin sivuston alahakemistolle `/admin`, ja sain tietää, että "Admin interface only available if logged in as an administrator, or if requested from loopback ". Mielenkiintoista. Menin satunnaisen tuotteen sivuille, ja kaappasin ZAPilla pyynnön tarkistaa tuotteen saatavuutta:

![](17.png)

Sain rajapintatietoa muokkaamalla tietooni urlin, jolla poiston pitäisi onnistua:

![](18.png)

Toistin edelliset askeleet, mutta osoitteeksi laitoin `stockApi=http://localhost/admin/delete?username=carlos`. Labra meni hyväksytysti läpi. 

#####    Cross Site Scripting (XSS)

i\) [Reflected XSS into HTML context with nothing encoded](https://portswigger.net/web-security/cross-site-scripting/reflected/lab-html-context-nothing-encoded)

" This lab contains a simple reflected cross-site scripting vulnerability in the search functionality.

To solve the lab, perform a cross-site scripting attack that calls the alert function. "

Syötin hakulaatikkoon `<script>alert(1)</script>`. Koodi ajettiin ja sivusto avasi ilmoituksena alert-laatikon jossa oli viestinä '1'.

![](19.png)

j\) [Stored XSS into HTML context with nothing encoded](https://portswigger.net/web-security/cross-site-scripting/stored/lab-html-context-nothing-encoded)

" This lab contains a stored cross-site scripting vulnerability in the comment functionality.

To solve this lab, submit a comment that calls the alert function when the blog post is viewed. "

Avasin blogisivuston, ja menin kommenttiosioon. Tällä kertaa scripti kirjoitettiin viestikenttään.

![](20.png)

Kun palasin blogin sivustolle, alert-ikkuna aukesi. Kokeilin myös huvikseen toiselle sivustolle labrassa viestikenttään `<script>alert("pwned")</script>` ja sekin toimi.

![](21.png)

Sivusto siis ajaa koodia kommenttikenttään syötetyistä syötteistä kuin se olisi HTML-koodia.

---

k\) Asenna Webgoat 2023.4.

[https://terokarvinen.com/2023/webgoat-2023-4-ethical-web-hacking/](https://terokarvinen.com/2023/webgoat-2023-4-ethical-web-hacking/)

Seurasin ohjeita ja ajoin seuraavat komennot (updaten olin ajanut jo koneen käynnistyksen yhteydessä)

```

┌──(susi㉿isopaha)-[~]
└─$ sudo apt-get install openjdk-17-jre

┌──(susi㉿isopaha)-[~]
└─$ sudo apt-get install ufw    

┌──(susi㉿isopaha)-[~]
└─$ sudo ufw enable
Firewall is active and enabled on system startup

┌──(susi㉿isopaha)-[~]
└─$  wget https://github.com/WebGoat/WebGoat/releases/download/v2023.4/webgoat-2023.4.jar 

┌──(susi㉿isopaha)-[~]
└─$ java -Dfile.encoding=UTF-8 -Dwebgoat.port=9999 -Dwebwolf.port=6969 -jar webgoat-2023.4.jar
Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
2023-11-19 06:54:37.688  INFO 114781 --- [           main] org.owasp.webgoat.server.StartWebGoat    : Starting StartWebGoat v2023.4 using Java 17.0.9 on isopaha with PID 114781 (/home/susi/webgoat-2023.4.jar started by susi in /home/susi)
2023-11-19 06:54:37.696  INFO 114781 --- [           main] org.owasp.webgoat.server.StartWebGoat    : No active profile set, falling back to 1 default profile: "default"               
2023-11-19 06:54:38.327  INFO 114781 --- [           main] org.owasp.webgoat.server.StartWebGoat    : Started StartWebGoat in 1.783 seconds (JVM running for 3.124)                     
    __          __       _        _____                   _
    \ \        / /      | |      / ____|                 | |
     \ \  /\  / /  ___  | |__   | |  __    ___     __ _  | |_
      \ \/  \/ /  / _ \ | '_ \  | | |_ |  / _ \   / _' | | __|
       \  /\  /  |  __/ | |_) | | |__| | | (_) | | (_| | | |_
        \/  \/    \___| |_.__/   \_____|  \___/   \__,_|  \__|


```

Tuloste jatkui useita rivejä tämän jälkeen, mutta se näytti lupaavalta. Viimeinen rivi kertoi `2023-11-19 06:55:06.727  INFO 114781 --- [           main] org.owasp.webgoat.server.StartupMessage  : Please browse to http://127.0.0.1:9999/WebGoat to get started...            `

WebGoat on erittäin haavoittuvainen kohde, joten otin varuiksi vielä "verkkojohdon" pois virtuaalikoneestani.

![](22.png)

Hyvältä näyttää! Painoin sisäänkirjautumissivulla rekisteröintinappulaa, ja tässä vielä WebGoatin Terms of Servicestä: 

```

While running this program your machine will be extremely vulnerable to attack.You should disconnect from the Internet while using this program. WebGoat's default configuration binds to localhost to minimize the exposure.

This program is for educational purposes only. If you attempt these techniques without authorization, you are very likely to get caught. If you are caught engaging in unauthorized hacking, most companies will fire you. Claiming that you were doing security research will not work as that is the first thing that all hackers claim.

```

#### Ratkaise WebGoat 2023.4:

[EDIT: Tehtävien tekemistä jatkettu 10.12.2023.]

m\) (A1) Broken Access Control (WebGoat 2023.4)
  * Hijack a session (1)

Kaappasin liikenteen ZAPilla ja syötin käyttäjätietoihin ja salasanaan 'root' ja 'admin'. Vastauksena saatu keksitieto (johon ohjattiin tehtävän vihjeissä) oli muotoa `Cookie: JSESSIONID=F878NGkuAMOPaYjUXnl3u083eQJGPVo2CPM_QSi6; hijack_cookie=4674523596670369714-1700370416236`

En keksinyt miten käyttää tätä tietoa hyödyksi, mutta esim. Youtubesta löytyi [video](https://www.youtube.com/watch?v=YO8rsCMVUyY) jossa selostetaan ratkaisu ja luodaan skripti vastauksen löytämiseksi. Ajanpuutteen vuoksi täydennän ~~tämän ja~~ loput tehtävät myöhemmin.

  * Insecure Direct Object References (4)

IDORin ensimmäisellä sivulla kerrottiin DORista yleisesti. Direct Object Referencet tekevät esim. GET, POST, PUT-pyyntöjen avulla pyyntöjä palvelimelle datan ja objektien saavuttamiseksi. Toisella sivulla pyydettiin kirjautumaan normaalisti, sillä usein IDOR-hyökkäykset onnistuvat olemassaolevalla käyttäjällä, jolla ei olisi normaalisti oikeuksia kohteisiin. 

![Alt text](image.png)

Siirryin seuraavaan kohtaan, jossa pyydettiin tarkastelemaan käyttäjän tietoja, ja vertailemaan niitä oikeasti käyttäjistä saatavilla oleviin tietoihin. Tässä esimerkkitapauksessa 'View Profile'-nappi näyttää vain nimen, värin ja koon. F12 painamalla, ja napin pyynnön Responsea tarkastelemalla löydetään, että käyttäjästä tiedetään myös userId ja role!

![Alt text](image-1.png)

![Alt text](image-2.png)

Seuraavassa kohdassa tarvittiin GET-pyynnöstä saatua osoitetta `[...]/WebGoat/IDOR/profile/`:

![Alt text](image-3.png)

Kohta 4 sai päänraaputuksia aikaan. Kaappasin pyynnön ZAPilla onnistuneesti, ja yritin userID:ksi muutamia lukuja omani vierestä, mutta se ei onnistunut. [https://github.com/WebGoat/WebGoat/wiki/Main-Exploits#insecure-direct-object-reference-lesson-5-exercise](https://github.com/WebGoat/WebGoat/wiki/Main-Exploits#insecure-direct-object-reference-lesson-5-exercise) WebGoatin wikissä kerrottiin, että userId tulisi hankkia esimerkiksi fuzzaamalla... Kokeillaan heittää ffuffiin. Kikkailin hetken aikaa erilaisilla ratkaisukeinoilla, joiden lähteenä toimi [https://www.acceis.fr/ffuf-advanced-tricks/](https://www.acceis.fr/ffuf-advanced-tricks/). Tarkoituksena oli fuzzata verkko-osoitetta ../Webgoat/IDOR/profile/ ja sijoittaa loppuun muuttujaksi numeroarvoja. Kokeilin aluksi isoja määriä numeroita, kuten väliä 0-2342384. Tässä kesti (ei yllättäen) järkyttävän kauan, joten päätin siirtyä pienempään rangeen.

```

┌──(susi㉿susi)-[~]
└─$ for i in {2342380..2342399}; do echo $i; done | ffuf -c -u 'http://127.0.0.1:8888/WebGoat/IDOR/profile/FUZZ' -w -


```

Kaikki läpikäydyt id:t antoivat 302-vastausta. Tämä on outoa, koska lunttasin WebGoatin wikistä, että userId `2342388` tuottaa Buffalo Billin profiilitiedot. Jäi vähän epäselväksi, että millä tapaa tätä olisi pitänyt fuzzata.. Eri työkalulla? Eri metodilla? Fuzzaaminen käyttämälläni tavalla vastaa sitä, että muuttujalla käytettyä osoitetta runnottaisiin selaimen osoitepalkkiin. Tietoja taasen saa vain GET-pyynnöllä. Kokeilin myös ZAPin fuzzeria, yhtä huonoilla tuloksilla.

Ja asiaa selvitellessäni huomasin, että WebGoat oli timeoutannut sessioni, ja unohtanut, että olen tehtävässä kirjautuneena "käyttäjänä 'tom'". Ja sitä myöten fuzzaus ei onnistunut. Kirjauduin uudestaan, ja nyt fuzzaus onnistui ZAPissa (mutta ei ffuf:ssa).

![Alt text](image-4.png)

Hienoa, nyt tiedetään userId. Sitten koitetaan tehdä sillä jotain muutoksia käyttäjälle. Avasin Request editorin, ja vaihdoin metodiksi PUT. Sitten lisäsin pyynnön bodyyn json-muodossa halutut muutokset tietoihin. Lopuksi wikin ohjeiden mukaisesti vaihdoin sisällön tyypin json:iksi.

![Alt text](image-5.png)

![Alt text](image-6.png)

Tämä selvensi hieman että mitä haluttiin tehdä. Varsinaiset toimet haluttujen muutosten tekemiseksi eivät vielä olleet minulle tuttuja, joten ehkä pitää lukea REST-rajapinnoista tarkemmin näitä hyökkäyksiä varten.

  * Missing Function Level Access Control (3)
¨
Ensimmäisessä kohdassa etsittiin lähdekoodista piilotettuja elementtejä lähdekoodista. Katselin F12-näppäimen Inspector-työkalulla ja löysin sekä `User` & `Config`-valikot piilotetusta tiputusvalikosta.

![Alt text](image-7.png)

![](image-8.png)

Otetaan vinkin pohjalta urlit talteen: `http://127.0.0.1:8888/access-control/users` `http://127.0.0.1:8888/access-control/config`

Urkin wikistä, että pyyntöön on vaihdettava pyynnön tyypiksi json:

![Alt text](image-9.png)

![Alt text](image-10.png)

Palautetaan hash `SVtOlaa+ER+w2eoIIVE5/77umvhcsh5V8UyDLUa1Itg=` weppisivulle:

![Alt text](image-11.png)

Viimeistä kohtaa en jäänyt selvittelemään, sillä läksyissäkin Tero arveli tehtävän olevan rikki.. [https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h4-totally-legit-sertificate](https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h4-totally-legit-sertificate)
        
  * Spoofing an Authentication Cookie (1)

[https://www.youtube.com/watch?v=-n4OmhUN3vA](https://www.youtube.com/watch?v=-n4OmhUN3vA) Katsoin ohjeeksi tälläisen videon.. Ratkaisu on todellakin hassu. Kokeilen käytännön ratkaisua myöhemmin.

n\) (A7) Identity & Auth Failure (WebGoat 2023.4)

  * Authentication Bypasses (1)

Tehtävässä pyydetään ohittamaan turvakysymykset jotka käyttäjä on asettanut, mutta kirjautuessaan sisään "unohtanut". Otin pyynnön, ja kokeilin pyöritellä POSTin parametreja. Vasta muuttamalla secQuestionin arvoja numeroille 3 ja 4 tehtävä ratkesi. Tämä varmaankin toimii siksi, että turvakysymysten vastaukset ovat noille asettamatta, jolloin tyhjäksi jätetty kenttä ainakin toimii.

![Alt text](image-12.png)

  * Insecure Login (1)

Tehtävä on hyvin simppeli: pysäytä paketti snifferillä (ZAP) ja kerää sieltä kirjautumistiedot talteen. Tämä olisi ollut huomattavasti mukavampi tehtävä heti kärkeen, kuin A1-kohdan keksinratkonta!

![](image-13.png)

![Alt text](image-14.png)

o\) (A10) Server-side Request Forgery (WebGoat 2023.4)

  * Server-Side Request Forgery (2)

Tämäkin tehtävä vaikutti erittäin yksinkertaiselta. Tosin järkevyydestä en kommentoi. Kaappaa POST-pyyntö, ja vaihda bodyyn Tomin tilalle Jerry...

![Alt text](image-15.png)

![Alt text](image-16.png)

Seuraava kohta:

![](image-17.png)

Vaihdetaan bodyyn taas pyydetty osoite:

![Alt text](image-18.png)

![Alt text](image-19.png)

Epäselväksi jää, miten nämä saa ZAPissa selaimeen näkyviin.

p\) Client side (WebGoat 2023.4)

  * Bypass front-end restrictions (2)

Muokattiin POSTin bodya ZAPilla:

![Alt text](image-20.png)

![Alt text](image-21.png)

Ja toinen kohta samalla kaavalla:

![Alt text](image-24.png)

Kaapataan POST ja editoidaan.

![](image-22.png)

![Alt text](image-23.png)